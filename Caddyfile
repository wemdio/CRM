{
	# Enable FrankenPHP
	frankenphp
	order php_server before file_server
}

# Timeweb may route traffic to different internal ports depending on app type.
# Listen on a few common ones to avoid "white screen" due to port mismatch.
:80, :8080, :8000, :3000 {
	# Log every request to stdout so we can see if Timeweb actually routes traffic here
	log {
		output stdout
		format console
	}

	# Marker header to confirm requests are hitting THIS container config (not some edge)
	header X-App-Version "da80910"

	# Healthcheck (must be handled before php_server)
	handle_path /healthz* {
		header Content-Type "text/plain; charset=utf-8"
		respond "ok" 200
	}

	# Default app handler
	handle {
		# Set the root to the public directory
		root * /app/public

		# Enable compression
		encode zstd gzip

		# Enable PHP server
		php_server
	}
}

